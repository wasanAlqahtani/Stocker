{% extends 'main/base.html' %}

{% block title %}
Products Page
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
<button type="button" class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#addProductModal">
  Add Product
</button>
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{% url 'product:add_product_view' %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Add Product</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <!-- Form fields -->
          <div class="mb-3">
            <label for="name" class="form-label">Product Name</label>
            <input type="text" class="form-control" name="name" required>
          </div>

          <div class="mb-3">
            <label for="supplier_id" class="form-label">Supplier</label>
            <select class="form-select" name="supplier_id" required>
              {% for supplier in suppliers %}
              <option value="{{ supplier.id }}">{{ supplier.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="mb-3">
            <label for="category_id" class="form-label">Category</label>
            <select class="form-select" name="category_id" required>
              {% for category in categories %}
              <option value="{{ category.id }}">{{ category.name }}</option>
              {% endfor %}
            </select>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary btn-sm">Add Product</button>
        </div>
      </form>
    </div>
  </div>
</div>

    <form method="GET" class="d-flex gap-2">
      <select class="form-select form-select-sm" name="supplier_filter" id="supplier_filter">
        <option value="">Filter by Supplier</option>
        {% for supplier in suppliers %}
          <option value="{{ supplier.id }}">{{ supplier.name }}</option>
        {% endfor %}
      </select>

      <select class="form-select form-select-sm" name="category_filter" id="category_filter">
        <option value="">Filter by Category</option>
        {% for category in categories %}
          <option value="{{ category.id }}">{{ category.name }}</option>
        {% endfor %}
      </select>
      <button type="submit" class="btn btn-outline-secondary btn-sm">Filter</button>
    </form>

</div>

<table class="table table-striped align-middle">
  <thead class="table-light">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Product Name</th>
      <th scope="col">Category</th>
      <th scope="col">Status</th>
      <th scope="col">Quantity</th>
      <th scope="col">Price</th>
      <th scope="col"> Edit & Delete</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products %}
    <tr>
      <th scope="row">{{ forloop.counter }}</th>

      <td>
        <a href="{% url 'product:product_detail_view' product.id %}" class="text-decoration-none">
          {{ product.name }}
        </a>
      </td>

      <td>{{ product.category.category_name }}</td>
      <td>{{ product.quantity }}</td>
      <td>{{ product.price }}</td>
      <td>
        <a href="{% url 'product:update_product_view' product.id %}" class="text-warning me-2">
          <i class="bi bi-pencil-square"></i>
        </a>
        <a href="{% url 'product:delete_product_view' product.id %}" class="text-danger" onclick="return confirm('Are you sure you want to delete this product?')">
          <i class="bi bi-trash3"></i>
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}